/* ==UserStyle==
@name			Mastodon未収載アイコン変更
@description	Mastodonの未収載トゥートのブーストアイコンを、公開トゥートとは別のものに変更してわかりやすくする
@namespace		https://github.com/Phroneris
@version		1.0.5
@author			森の子リスのミーコの大冒険（Phroneris）
@homepageURL	https://github.com/Phroneris/StylusUserCSS-Phroneris
@supportURL		https://github.com/Phroneris/StylusUserCSS-Phroneris/issues
@updateURL		https://github.com/Phroneris/StylusUserCSS-Phroneris/raw/master/usercss/mastodon_unlisted-icon.user.styl
@license		CC0-1.0
@preprocessor	stylus

@var			select icon "ブーストアイコン" {
	"片矢印": "halfArrow",
	"開ききった鍵": "openFull",
	"開いた鍵": "open"
}
==/UserStyle== */

/* ==ChangeLog==

	2021/02/03 v1.0.5
	* 各種URLのリポジトリ名を修正

	2020/03/08 v1.0.4
	* 未収載トゥートをブーストした際の「●●さんがブースト」の直前に出現してしまうのを修正
	* ネストのしかたを少し変更

	2019/06/20 v1.0.3
	* サイト選択をドメイン式ではなくURL式に変更
	* @updateURLを`*.styl`に変更

	2019/02/22 v1.0.2
	* リポジトリ整理に伴い@updateURLを修正

	2019/02/21 v1.0.1
	* このChangeLogを追加
	* Mastodon v2.7.2でトゥート編集欄の未収載マークが変更されたのをうけて「開ききった鍵」の選択肢を追加
	* 対応インスタンスを追加（自分のために）
	* 片矢印のhover時に本来のアイコンになっていなかったのを修正
	* 片矢印の生SVGを少し軽量化
	* 色変え機能の実装を挫折

*/

/*
// 色変え機能をつけようとしたが、鍵系選択肢でも生SVGを書くハメになることに気付き、
// 生SVGはソース内でめちゃくちゃスペースを占めるのがめちゃくちゃ邪魔なのでめんどくてやめた。
@var			checkbox changeCol "色変え（全インスタンスに適用）" 1
@var			color colNormal "普段の色" #606984
@var			color colBoost "ブースト色" #2B90D9
	stringer(col, def) // 頭の#を落とす
		col = changeCol ? col : def
		return slice(s('%s', col), 1)
	sCN = stringer(colNormal, #606984)
	sCB = stringer(colBoost, #2B90D9)
	.drawer__inner // テスト用
		background-color: colNormal !important
		unko: sCN
	// あとは生SVGの "fill='%23606984'" のとこを "fill='%23" + sCN + "'" などとする。
*/

@-moz-document regexp("^https://[^/]+?/web/.+$")
	// ちなみにQiitadonでは片矢印の色が微妙に食い違う（2019/2/19時点）。

	body > #mastodon div.status__wrapper-unlisted .status__action-bar-button > i.fa-retweet:not(:hover)

		if icon == "openFull"
			/*	・普段         ：開ききった鍵
				・hover        ：本来
				・BT真っ最中   ：本来（アニメーション）
				・普段（BT後） ：開ききった鍵（青）
				・hover（BT後）：本来（青）
			*/
			background-image: none
			&::after
				content: "\F09C"

		else if icon == "open"
			/*	・普段         ：やや開いた鍵
				・hover        ：本来
				・BT真っ最中   ：本来（アニメーション）
				・普段（BT後） ：やや開いた鍵（青）
				・hover（BT後）：本来（青）
			*/
			background-image: none	// 本来のリツイート図形を非表示
			&::after
				content: "\F13E"	// なぜかbeforeではなくafterじゃないと効かない

		else if icon == "halfArrow"
			/*	・普段         ：片方だけの矢印
				・hover        ：本来
				・BT真っ最中   ：本来（アニメーション）
				・普段（BT後） ：片方だけの矢印（青）
				・hover（BT後）：本来（青）
			*/
			background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='22' height='209'><path d='m17.13 3.59c-0.55-0.02-1.32 0.02-2.4 0.02h-10.862l2.32 2.85 0.03 0.06h8.4819c0.42 0 0.72 0.28 0.72 0.72v2.7h-2.5c-0.36 0.02-0.56 0.54-0.3 0.8l3.92 4.9c0.18 0.25 0.6 0.25 0.78 0l3.94-4.9c0.26-0.28 0-0.83-0.37-0.8h-2.49v-2.7c0-3.15 0.4-3.62-1.25-3.66z' fill='%23606984' stroke-width='0'/><path d='m7.78 19.66c-0.24 0.02-0.44 0.25-0.44 0.5v2.46h-0.06c-1.08 0-1.86-0.03-2.4-0.03-1.64 0-1.25 0.43-1.25 3.65v4.47c0 4.26-0.56 3.62 3.65 3.62h1.22l-1.3-1.06c-0.1-0.08-0.18-0.2-0.2-0.3-0.02-0.17 0.06-0.35 0.2-0.45l1.33-1.1h-1.25c-0.44 0-0.72-0.3-0.72-0.7v-4.48c0-0.44 0.28-0.72 0.72-0.72h0.06v2.5c0 0.38 0.54 0.63 0.82 0.38l4.9-3.93c0.25-0.18 0.25-0.6 0-0.78l-4.9-3.92c-0.1-0.1-0.24-0.14-0.38-0.12zm9.34 2.93c-0.54-0.02-1.3 0.02-2.4 0.02h-1.25l1.3 1.07c0.1 0.07 0.18 0.2 0.2 0.33 0.02 0.16-0.06 0.3-0.2 0.4l-1.33 1.1h1.28c0.42 0 0.72 0.28 0.72 0.72v4.47c0 0.42-0.3 0.72-0.72 0.72h-0.1v-2.47c0-0.3-0.3-0.53-0.6-0.47-0.07 0-0.14 0.05-0.2 0.1l-4.9 3.93c-0.26 0.18-0.26 0.6 0 0.78l4.9 3.92c0.27 0.25 0.82 0 0.8-0.38v-2.5h0.1c4.27 0 3.65 0.67 3.65-3.62v-4.47c0-3.15 0.4-3.62-1.25-3.66zm-6.78 16.07c-0.24 0.02-0.44 0.25-0.43 0.5v2.47h-2.61c-1.08 0-1.86-0.04-2.4-0.04-1.64 0-1.25 0.43-1.25 3.65v4.47c0 3.66-0.23 3.7 2.34 3.66l-1.34-1.1c-0.1-0.08-0.18-0.2-0.2-0.3 0-0.17 0.07-0.35 0.2-0.45l1.96-1.6c-0.03-0.06-0.04-0.13-0.04-0.2v-4.48c0-0.44 0.28-0.72 0.72-0.72h2.61v2.5c0 0.36 0.5 0.6 0.8 0.38l4.93-3.93c0.24-0.18 0.24-0.6 0-0.78l-4.94-3.92c-0.1-0.08-0.23-0.13-0.36-0.12zm5.63 2.93 1.34 1.1c0.1 0.07 0.18 0.2 0.2 0.33 0.02 0.16-0.03 0.3-0.16 0.4l-1.96 1.6c0.02 0.07 0.06 0.13 0.06 0.22v4.47c0 0.42-0.3 0.72-0.72 0.72h-2.66v-2.47c0-0.3-0.3-0.53-0.6-0.47-0.06 0.02-0.12 0.05-0.18 0.1l-4.94 3.93c-0.24 0.18-0.24 0.6 0 0.78l4.94 3.92c0.28 0.22 0.78-0.02 0.78-0.38v-2.5h2.66c4.27 0 3.65 0.67 3.65-3.62v-4.47c0-3.66 0.34-3.7-2.4-3.66zm-2.91 16.07c-0.23 0.03-0.4 0.26-0.4 0.5v2.47h-5.38c-1.08 0-1.86-0.04-2.4-0.04-1.64 0-1.25 0.43-1.25 3.65v4.87l2.93-2.37v-2.5c0-0.44 0.28-0.72 0.72-0.72h5.38v2.5c0 0.36 0.5 0.6 0.78 0.38l4.94-3.93c0.24-0.18 0.24-0.6 0-0.78l-4.94-3.92c-0.1-0.1-0.24-0.14-0.38-0.12zm5.3 6.15-2.92 2.4v2.52c0 0.42-0.3 0.72-0.72 0.72h-5.4v-2.47c0-0.3-0.32-0.53-0.6-0.47-0.07 0.02-0.13 0.05-0.2 0.1l-4.92 3.91c-0.25 0.18-0.25 0.6 0 0.78l4.93 3.92c0.28 0.22 0.78-0.02 0.78-0.38v-2.5h5.42c4.27 0 3.65 0.67 3.65-3.62v-4.91zm0.89 14.99c-0.1 0.03-0.2 0.1-0.28 0.17l-0.9 0.9c-0.44-0.3-1.36-0.25-3.35-0.25h-7.44c-1.08 0-1.86-0.03-2.4-0.03-1.64 0-1.25 0.43-1.25 3.65v0.7l2.93 0.3v-1c0-0.44 0.28-0.72 0.72-0.72h7.44c0.2 0 0.37 0.08 0.5 0.2l-1.8 1.8c-0.25 0.26-0.08 0.76 0.27 0.8l6.27 0.7c0.28 0.03 0.56-0.25 0.53-0.53l-0.7-6.25c0-0.27-0.3-0.48-0.55-0.44zm-17.2 6.1c-0.2 0.07-0.36 0.3-0.33 0.54l0.7 6.25c0.02 0.36 0.58 0.55 0.83 0.27l0.8-0.8c0.02 0 0.04-0.02 0.04 0 0.46 0.24 1.37 0.17 3.18 0.17h7.44c4.27 0 3.65 0.67 3.65-3.62v-0.75l-2.93-0.3v1.05c0 0.42-0.3 0.72-0.72 0.72h-7.43c-0.15 0-0.3-0.03-0.4-0.1l1.92-1.93c0.3-0.24 0.1-0.8-0.27-0.84l-6.28-0.65h-0.2zm2.83 13.7c-1.33 0-1.34 0.48-1.3 2.3l1.14-1.37c0.08-0.1 0.22-0.17 0.34-0.2 0.16 0 0.34 0.08 0.44 0.2l1.66 2.03c0.04 0 0.07-0.03 0.12-0.03h7.44c0.34 0 0.57 0.2 0.65 0.5h-2.43c-0.34 0.05-0.53 0.52-0.3 0.78l3.92 4.95c0.18 0.24 0.6 0.24 0.78 0l3.94-4.94c0.22-0.27-0.02-0.76-0.37-0.77h-2.51c0.02-3.9 0.6-3.4-3.66-3.4h-7.46c-1.08 0-1.86-0.04-2.4-0.04zm0.15 2.46c-0.1 0.03-0.2 0.1-0.28 0.2l-3.94 4.9c-0.2 0.28 0.03 0.77 0.4 0.78h2.39c-0.02 3.94-0.45 3.4 3.66 3.4h7.44c3.65 0 3.74 0.3 3.7-2.25l-1.1 1.34c-0.1 0.1-0.2 0.17-0.32 0.2-0.16 0-0.34-0.08-0.44-0.2l-1.65-2.03c-0.06 0.02-0.1 0.04-0.18 0.04h-7.43c-0.35 0-0.57-0.2-0.66-0.5h2.44c0.37 0 0.63-0.5 0.4-0.78l-3.96-4.9c-0.1-0.15-0.3-0.23-0.47-0.2zm-0.15 16.54c-1.16 0-1.3 0.3-1.3 1.56l1.14-1.38c0.08-0.1 0.22-0.14 0.34-0.16 0.16 0 0.34 0.04 0.44 0.16l2.22 2.75h7c0.42 0 0.72 0.28 0.72 0.72v0.53h-2.6c-0.3 0.1-0.43 0.54-0.2 0.78l3.92 4.9c0.18 0.25 0.6 0.25 0.78 0l3.94-4.9c0.22-0.28-0.02-0.77-0.37-0.78h-2.51v-0.53c0-4.2 0.72-3.63-3.66-3.63h-7.46c-1.08 0-1.86-0.03-2.4-0.03zm0.1 1.74c-0.1 0.03-0.17 0.1-0.23 0.16l-3.95 4.94c-0.2 0.28 0.03 0.77 0.4 0.78h2.4v0.5c0 4.26-0.55 3.62 3.66 3.62h7.44c1.03 0 1.74 0.02 2.28 0-0.16 0.02-0.34-0.03-0.44-0.15l-2.22-2.76h-7.04c-0.44 0-0.72-0.3-0.72-0.72v-0.5h2.5c0.37 0.02 0.63-0.5 0.4-0.78l-3.96-4.93c-0.12-0.15-0.34-0.22-0.53-0.16zm12.02 10c1.2-0.02 1.4-0.25 1.4-1.53l-1.1 1.36c-0.07 0.1-0.17 0.17-0.3 0.18zm-11.06 7.26 2.37 2.93h6.42c0.42 0 0.72 0.28 0.72 0.72v1.25h-2.6c-0.3 0.1-0.43 0.54-0.2 0.78l3.92 4.9c0.18 0.25 0.6 0.25 0.78 0l3.94-4.9c0.22-0.28-0.02-0.77-0.37-0.78h-2.52v-1.25c0-4.2 0.72-3.63-3.66-3.63h-7.46c-0.6 0-0.92-0.02-1.34-0.03zm-1.72 0.06c-0.4 0.08-0.54 0.3-0.6 0.75l0.6-0.74zm0.84 0.93c-0.12 0-0.24 0.08-0.3 0.18l-3.95 4.9c-0.24 0.3 0 0.83 0.4 0.82h2.39v1.22c0 4.26-0.55 3.62 3.66 3.62h7.44c0.63 0 0.97 0.02 1.4 0.03l-2.37-2.93h-6.45c-0.44 0-0.72-0.3-0.72-0.72v-1.22h2.5c0.4 0.04 0.67-0.53 0.4-0.8l-3.96-4.92c-0.1-0.13-0.27-0.2-0.44-0.2zm13.28 10.03-0.56 0.7c0.36-0.07 0.5-0.3 0.56-0.7zm-1.21 7.98c-0.55-0.02-1.32 0.03-2.4 0.03h-8.2l2.38 2.9h5.82c0.42 0 0.72 0.28 0.72 0.72v1.97h-2.55c-0.32 0.06-0.48 0.52-0.28 0.78l3.94 4.94c0.2 0.23 0.6 0.22 0.78-0.03l3.94-4.9c0.22-0.28-0.02-0.77-0.37-0.78h-2.51v-1.97c0-3.15 0.4-3.62-1.25-3.66zm-12.1 0.28c-0.1 0.02-0.2 0.1-0.28 0.18l-3.94 4.9c-0.2 0.3 0.03 0.78 0.4 0.8h2.39v1.96c0 4.26-0.55 3.62 3.66 3.62h8.24l-2.36-2.9h-5.86c-0.44 0-0.72-0.3-0.72-0.72v-1.97h2.5c0.37 0.02 0.63-0.5 0.4-0.78l-3.96-4.9c-0.1-0.15-0.3-0.22-0.47-0.2zm0.1 18.62c-0.15 0-0.3 0.07-0.38 0.2l-3.95 4.9c-0.24 0.27 0 0.82 0.4 0.8h2.4v2.32c0 4.26-0.55 3.62 3.66 3.62h7.94l-2.35-2.9h-5.6c-0.43 0-0.7-0.3-0.7-0.72v-2.3h2.5c0.38 0.03 0.66-0.54 0.4-0.83l-3.97-4.9c-0.1-0.13-0.23-0.2-0.38-0.2zm12 0.1c-0.55-0.02-1.32 0.03-2.4 0.03h-7.9l2.35 2.9h5.52c0.42 0 0.72 0.28 0.72 0.72v2.34h-2.6c-0.3 0.1-0.43 0.53-0.2 0.78l3.92 4.9c0.18 0.24 0.6 0.24 0.78 0l3.94-4.9c0.22-0.3-0.02-0.78-0.37-0.8h-2.49v-2.33c0-3.15 0.4-3.62-1.25-3.66zm0 18.99c-0.55-0.02-1.32 0.03-2.4 0.03h-10.862l2.32 2.84 0.03 0.06h8.4819c0.42 0 0.72 0.28 0.72 0.72v2.7h-2.5c-0.36 0.02-0.56 0.54-0.3 0.8l3.92 4.9c0.18 0.25 0.6 0.25 0.78 0l3.94-4.9c0.26-0.28 0-0.83-0.37-0.8h-2.49v-2.7c0-3.15 0.4-3.62-1.25-3.66z' fill='%232b90d9' stroke-width='0'/></svg>")


